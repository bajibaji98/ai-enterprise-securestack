worker_processes 1;
events { worker_connections 1024; }
http {
  map \ \ { default \; "" \; }
  server {
    listen 443 ssl http2;
    server_name localhost;
    ssl_certificate     /etc/nginx/certs/server.crt;
    ssl_certificate_key /etc/nginx/certs/server.key;

    location = /health { return 200 'OK'; add_header Content-Type text/plain; }
    location / {
      proxy_pass http://api-service:7000;
      proxy_set_header Host \System.Management.Automation.Internal.Host.InternalHost;
      proxy_set_header X-Request-ID \;
      proxy_set_header X-Forwarded-Proto https;
      proxy_set_header X-Forwarded-For \;
      proxy_read_timeout 15s;
    }
  }
}
